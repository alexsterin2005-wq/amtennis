<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AM Tennis Academy - Book a Lesson</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
    }
    @keyframes spin {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
    .tennis-ball-spinner {
      animation: spin 1s linear infinite;
      display: inline-block;
      font-size: 3rem;
    }
  </style>
</head>
<body class="bg-gray-100">
  <div id="app"></div>

  <script>
    // Initialize EmailJS
    emailjs.init("ianNIvcpna6GOLZAi");

    // Initialize Firebase
    const firebaseConfig = {
      apiKey: "AIzaSyBTxeuqswDst4Gh4OMvswTDaqG2llQ0ivY",
      authDomain: "am-tennis.firebaseapp.com",
      projectId: "am-tennis",
      storageBucket: "am-tennis.firebasestorage.app",
      messagingSenderId: "302418385368",
      appId: "1:302418385368:web:8b8e505efc68899cf6baad"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // Firebase Firestore storage
    const storage = {
      async getAll() {
        try {
          const snapshot = await db.collection('bookings').get();
          const bookings = [];
          snapshot.forEach(doc => {
            bookings.push({ id: doc.id, ...doc.data() });
          });
          return bookings;
        } catch (error) {
          console.error('Error getting bookings:', error);
          return [];
        }
      },
      
      async add(bookingData) {
        try {
          await db.collection('bookings').doc(bookingData.id).set(bookingData);
          return true;
        } catch (error) {
          console.error('Error adding booking:', error);
          return false;
        }
      },
      
      async update(bookingId, updates) {
        try {
          await db.collection('bookings').doc(bookingId).update(updates);
          return true;
        } catch (error) {
          console.error('Error updating booking:', error);
          return false;
        }
      },
      
      async delete(bookingId) {
        try {
          await db.collection('bookings').doc(bookingId).delete();
          return true;
        } catch (error) {
          console.error('Error deleting booking:', error);
          return false;
        }
      }
    };
    
    // Generate report organized by coach
    function generateCoachReport() {
      const bookings = storage.getAll().filter(b => b.status !== 'cancelled');
      
      // Group by coach
      const byCoach = {};
      bookings.forEach(booking => {
        if (!byCoach[booking.coach]) {
          byCoach[booking.coach] = [];
        }
        byCoach[booking.coach].push(booking);
      });
      
      // Generate report text
      let report = 'AM TENNIS ACADEMY - COACH HOURS REPORT\n';
      report += '=' .repeat(60) + '\n\n';
      report += `Generated: ${new Date().toLocaleString()}\n\n`;
      
      Object.keys(byCoach).sort().forEach(coach => {
        const lessons = byCoach[coach].sort((a, b) => new Date(a.date) - new Date(b.date));
        const totalHours = lessons.reduce((sum, l) => sum + (parseInt(l.duration) / 60), 0);
        const totalRevenue = lessons.reduce((sum, l) => sum + parseFloat(l.price), 0);
        
        report += `\n${'='.repeat(60)}\n`;
        report += `COACH: ${coach}\n`;
        report += `Total Lessons: ${lessons.length}\n`;
        report += `Total Hours: ${totalHours.toFixed(2)}\n`;
        report += `Total Revenue: $${totalRevenue.toFixed(2)}\n`;
        report += `${'='.repeat(60)}\n\n`;
        
        lessons.forEach(lesson => {
          report += `Date: ${lesson.date} at ${lesson.time}\n`;
          report += `  Client: ${lesson.name}\n`;
          report += `  Duration: ${lesson.duration} minutes (${(parseInt(lesson.duration) / 60).toFixed(2)} hours)\n`;
          report += `  Price: $${lesson.price}\n`;
          report += `  Status: ${lesson.status}\n`;
          if (lesson.notes) report += `  Notes: ${lesson.notes}\n`;
          report += `\n`;
        });
      });
      
      // Calculate grand totals
      const allBookings = bookings;
      const grandTotalHours = allBookings.reduce((sum, l) => sum + (parseInt(l.duration) / 60), 0);
      const grandTotalRevenue = allBookings.reduce((sum, l) => sum + parseFloat(l.price), 0);
      
      report += `\n${'='.repeat(60)}\n`;
      report += `GRAND TOTALS\n`;
      report += `${'='.repeat(60)}\n`;
      report += `Total Lessons: ${allBookings.length}\n`;
      report += `Total Hours: ${grandTotalHours.toFixed(2)}\n`;
      report += `Total Revenue: $${grandTotalRevenue.toFixed(2)}\n`;
      
      return report;
    }
    
    // Download report as text file
    function downloadReport() {
      const report = generateCoachReport();
      const blob = new Blob([report], { type: 'text/plain' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `tennis-coach-report-${new Date().toISOString().split('T')[0]}.txt`;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }

    // Coach authentication credentials
    const COACH_CREDENTIALS = {
      'alex': { password: '123', name: 'Alex' },
      'aaron': { password: '123', name: 'Aaron' },
      'mikkel': { password: '123', name: 'Mikkel' }
    };

    // Authentication functions
    function checkAuth() {
      const auth = localStorage.getItem('coach_auth');
      if (auth) {
        try {
          return JSON.parse(auth);
        } catch (e) {
          return null;
        }
      }
      return null;
    }

    function login(username, password) {
      const user = COACH_CREDENTIALS[username.toLowerCase()];
      if (user && user.password === password) {
        const authData = { username: username.toLowerCase(), name: user.name };
        localStorage.setItem('coach_auth', JSON.stringify(authData));
        return authData;
      }
      return null;
    }

    function logout() {
      localStorage.removeItem('coach_auth');
      state.isAuthenticated = false;
      state.currentCoach = null;
      state.view = 'booking';
      render();
    }

    // App State
    let state = {
      view: 'booking',
      bookings: [],
      loading: true,
      coach: 'Alex',
      date: '',
      duration: '60',
      selectedSlot: null,
      showSlots: false,
      name: '',
      email: '',
      phone: '',
      notes: '',
      message: { type: '', text: '' },
      sending: false,
      filter: 'all',
      isAuthenticated: false,
      currentCoach: null,
      loginError: '',
      weather: null,
      lastBooking: null,
      showPolicy: null
    };

    // Load bookings
    async function loadBookings() {
      try {
        const loadedBookings = await storage.getAll();
        state.bookings = loadedBookings.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));
      } catch (err) {
        console.error('Error loading bookings:', err);
        state.bookings = [];
      }
      state.loading = false;
      render();
    }

    // Generate time slots
    function generateTimeSlots() {
      const slots = [];
      for (let h = 8; h <= 20; h++) {
        const suffix = h >= 12 ? 'PM' : 'AM';
        let hour12 = h % 12;
        if (hour12 === 0) hour12 = 12;
        slots.push(`${hour12}:00 ${suffix}`);
      }
      return slots;
    }

    // Generate calendar .ics file
    function generateCalendarFile(bookingData) {
      const startDate = new Date(`${bookingData.date} ${bookingData.time}`);
      const endDate = new Date(startDate.getTime() + parseInt(bookingData.duration) * 60000);
      
      const formatDate = (date) => {
        return date.toISOString().replace(/[-:]/g, '').split('.')[0] + 'Z';
      };
      
      const icsContent = [
        'BEGIN:VCALENDAR',
        'VERSION:2.0',
        'PRODID:-//AM Tennis Academy//Booking//EN',
        'BEGIN:VEVENT',
        `UID:${bookingData.id}@amtennis.netlify.app`,
        `DTSTAMP:${formatDate(new Date())}`,
        `DTSTART:${formatDate(startDate)}`,
        `DTEND:${formatDate(endDate)}`,
        `SUMMARY:Tennis Lesson with Coach ${bookingData.coach}`,
        `DESCRIPTION:Tennis lesson at AM Tennis Academy\\n\\nCoach: ${bookingData.coach}\\nDuration: ${bookingData.duration} minutes\\nPrice: $${bookingData.price}\\n\\nLocation: Council Rock North High School Tennis Courts, 62 Swamp Rd, Newtown, PA 18940`,
        'LOCATION:Council Rock North High School Tennis Courts, 62 Swamp Rd, Newtown, PA 18940',
        'STATUS:CONFIRMED',
        'END:VEVENT',
        'END:VCALENDAR'
      ].join('\\r\\n');
      
      return icsContent;
    }
    
    // Download calendar file
    function downloadCalendar(bookingData) {
      const icsContent = generateCalendarFile(bookingData);
      const blob = new Blob([icsContent], { type: 'text/calendar;charset=utf-8' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `tennis-lesson-${bookingData.date}.ics`;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }

    // Fetch weather for selected date
    async function fetchWeather(date) {
      try {
        const response = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=40.23&longitude=-74.99&daily=temperature_2m_max,temperature_2m_min,precipitation_probability_max,weather_code&temperature_unit=fahrenheit&timezone=America/New_York&start_date=${date}&end_date=${date}`);
        const data = await response.json();
        
        if (data && data.daily) {
          const weatherCode = data.daily.weather_code[0];
          const tempMax = Math.round(data.daily.temperature_2m_max[0]);
          const tempMin = Math.round(data.daily.temperature_2m_min[0]);
          const rainChance = data.daily.precipitation_probability_max[0];
          
          // Weather code to emoji/description
          let weatherEmoji = '‚òÄÔ∏è';
          let weatherDesc = 'Clear';
          if (weatherCode === 0) { weatherEmoji = '‚òÄÔ∏è'; weatherDesc = 'Clear'; }
          else if (weatherCode <= 3) { weatherEmoji = '‚õÖ'; weatherDesc = 'Partly Cloudy'; }
          else if (weatherCode <= 49) { weatherEmoji = '‚òÅÔ∏è'; weatherDesc = 'Cloudy'; }
          else if (weatherCode <= 69) { weatherEmoji = 'üåßÔ∏è'; weatherDesc = 'Rainy'; }
          else if (weatherCode <= 79) { weatherEmoji = '‚ùÑÔ∏è'; weatherDesc = 'Snow'; }
          else { weatherEmoji = '‚õàÔ∏è'; weatherDesc = 'Stormy'; }
          
          return {
            emoji: weatherEmoji,
            description: weatherDesc,
            tempMax,
            tempMin,
            rainChance
          };
        }
      } catch (error) {
        console.error('Weather fetch error:', error);
      }
      return null;
    }

    // Check if slot is booked
    function isSlotBooked(timeSlot) {
      return state.bookings.some(
        b => b.coach === state.coach && b.date === state.date && b.time === timeSlot && b.status !== 'cancelled'
      );
    }

    // Send email
    async function sendEmail(bookingData) {
      const cancellationFee = bookingData.duration === '60' ? '$15' : '$20';
      const templateParams = {
        coach: bookingData.coach,
        date: bookingData.date,
        time: bookingData.time,
        duration: bookingData.duration,
        price: bookingData.price,
        name: bookingData.name,
        email: bookingData.email,
        phone: bookingData.phone,
        notes: bookingData.notes,
        booking_id: bookingData.id,
        location: 'Council Rock North High School Tennis Courts, 62 Swamp Rd, Newtown, PA 18940',
        payment_info: 'Payment Options: Venmo: @AMTennis | Zelle: amtennis2005@gmail.com | Card | Cash/Check accepted at lesson',
        cancellation_policy: `Cancellation Policy: ${cancellationFee} cancellation fee applies if cancelled within 24 hours of the scheduled lesson time.`
      };

      try {
        // Send email to customer
        await emailjs.send('service_38t1lwl', 'template_op0e8ca', templateParams);
        
        // Send notification to business email
        const businessParams = {
          ...templateParams,
          email: 'amtennis2005@gmail.com'
        };
        await emailjs.send('service_38t1lwl', 'template_op0e8ca', businessParams);
        
        return true;
      } catch (err) {
        console.error('Email error:', err);
        return false;
      }
    }

    // Handle booking
    async function handleBooking() {
      if (!state.date || !state.selectedSlot || !state.name || !state.email) {
        state.message = { type: 'error', text: 'Please fill in all required fields and select a time slot.' };
        render();
        return;
      }

      if (isSlotBooked(state.selectedSlot)) {
        state.message = { type: 'error', text: 'This time slot is no longer available. Please select another.' };
        render();
        return;
      }

      state.sending = true;
      state.message = { type: '', text: '' };
      render();

      const price = state.duration === '60' ? 65 : 97.5;
      const bookingNumber = 1000 + state.bookings.length + 1;
      const bookingId = `#${bookingNumber}`;
      
      const bookingData = {
        id: bookingId,
        coach: state.coach,
        date: state.date,
        time: state.selectedSlot,
        duration: state.duration,
        price: price.toFixed(2),
        name: state.name,
        email: state.email,
        phone: state.phone,
        notes: state.notes,
        status: 'confirmed',
        createdAt: new Date().toISOString()
      };

      try {
        await storage.add(bookingData);
        const emailSent = await sendEmail(bookingData);
        
        state.message = {
          type: 'success',
          text: `<div class="text-center mb-4"><div class="text-3xl font-bold text-green-700 mb-2">‚úÖ Booking Confirmed!</div><div class="text-2xl font-bold text-blue-600 bg-blue-50 inline-block px-6 py-3 rounded-lg border-2 border-blue-600">Confirmation #${bookingId}</div></div><div class="text-left mt-4"><strong>Lesson Details:</strong><br>üë§ ${state.name}<br>üéæ Coach ${state.coach}<br>üìÖ ${state.date} at ${state.selectedSlot}<br>‚è±Ô∏è ${state.duration} minutes<br>üíµ $${price.toFixed(2)}</div>${emailSent ? '<div class="mt-3 text-sm text-green-700">‚úâÔ∏è Confirmation email sent to ' + state.email + '</div>' : '<div class="mt-3 text-sm text-red-600">‚ö†Ô∏è Email notification failed</div>'}<div class="mt-4 text-center"><button onclick="downloadLessonCalendar()" class="bg-green-600 text-white px-6 py-3 rounded-full text-sm font-semibold hover:bg-green-700 inline-block">üìÖ Add to Calendar</button></div><div class="mt-4 pt-4 border-t"><strong>Payment Instructions:</strong><br>üí≥ Venmo: @AMTennis<br>üíµ Zelle: amtennis2005@gmail.com<br>üí∞ Cash/Check accepted at the lesson</div>`
        };

        // Store booking data for calendar download
        state.lastBooking = bookingData;

        // Reset form
        state.selectedSlot = null;
        state.showSlots = false;
        state.name = '';
        state.email = '';
        state.phone = '';
        state.notes = '';
        
        await loadBookings();
      } catch (err) {
        state.message = { type: 'error', text: 'Failed to save booking. Please try again.' };
      }

      state.sending = false;
      render();
    }

    // Update booking status
    async function updateBookingStatus(bookingId, newStatus) {
      try {
        await storage.update(bookingId, { status: newStatus });
        await loadBookings();
      } catch (err) {
        console.error('Failed to update booking:', err);
      }
    }

    // Delete booking
    async function deleteBooking(bookingId) {
      if (confirm('Are you sure you want to delete this booking?')) {
        try {
          await storage.delete(bookingId);
          await loadBookings();
        } catch (err) {
          console.error('Failed to delete booking:', err);
        }
      }
    }

    // Policy content
    function getTermsOfService() {
      return `
        <div class="space-y-6">
          <section>
            <h3 class="text-xl font-bold mb-3">1. Agreement to Terms</h3>
            <p class="text-gray-700">By booking a lesson with AM Tennis Academy, you agree to these Terms of Service. Please read them carefully before making a reservation.</p>
          </section>

          <section>
            <h3 class="text-xl font-bold mb-3">2. Services Provided</h3>
            <p class="text-gray-700 mb-2">AM Tennis Academy offers:</p>
            <ul class="list-disc ml-6 text-gray-700 space-y-1">
              <li>Private tennis lessons with Division 1 collegiate coaches</li>
              <li>Professional racquet stringing services</li>
              <li>Lessons conducted at Council Rock North High School Tennis Courts, 62 Swamp Rd, Newtown, PA 18940</li>
            </ul>
          </section>

          <section>
            <h3 class="text-xl font-bold mb-3">3. Booking and Payment</h3>
            <p class="text-gray-700 mb-2">Lesson Rates:</p>
            <ul class="list-disc ml-6 text-gray-700 space-y-1">
              <li>60-minute lesson: $65</li>
              <li>90-minute lesson: $97.50</li>
            </ul>
            <p class="text-gray-700 mt-3">Payment is accepted via Venmo (@AMTennis), Zelle (amtennis2005@gmail.com), or cash/check at the lesson. Payment can be made before or at the time of your lesson.</p>
          </section>

          <section>
            <h3 class="text-xl font-bold mb-3">4. Cancellation Policy</h3>
            <p class="text-gray-700 mb-2">Cancellation fees apply as follows:</p>
            <ul class="list-disc ml-6 text-gray-700 space-y-1">
              <li>60-minute lesson cancelled within 24 hours: $15 fee</li>
              <li>90-minute lesson cancelled within 24 hours: $20 fee</li>
              <li>No fee for cancellations made more than 24 hours before the scheduled lesson</li>
            </ul>
            <p class="text-gray-700 mt-3">To cancel, please contact us at amtennis2005@gmail.com or (267) 738-7290.</p>
          </section>

          <section>
            <h3 class="text-xl font-bold mb-3">5. Weather Policy</h3>
            <p class="text-gray-700">Lessons may be cancelled or rescheduled due to inclement weather at the coach's discretion. No cancellation fee applies for weather-related cancellations initiated by the coach.</p>
          </section>

          <section>
            <h3 class="text-xl font-bold mb-3">6. Liability and Assumption of Risk</h3>
            <p class="text-gray-700">Tennis is a physical activity that carries inherent risks. By participating, you acknowledge and accept these risks. AM Tennis Academy, its coaches, and affiliates are not liable for any injuries, losses, or damages that may occur during lessons or on the premises.</p>
          </section>

          <section>
            <h3 class="text-xl font-bold mb-3">7. Code of Conduct</h3>
            <p class="text-gray-700 mb-2">Students are expected to:</p>
            <ul class="list-disc ml-6 text-gray-700 space-y-1">
              <li>Arrive on time for scheduled lessons</li>
              <li>Treat coaches and other students with respect</li>
              <li>Follow safety guidelines and coach instructions</li>
              <li>Respect court facilities and equipment</li>
            </ul>
          </section>

          <section>
            <h3 class="text-xl font-bold mb-3">8. Modifications to Terms</h3>
            <p class="text-gray-700">AM Tennis Academy reserves the right to modify these terms at any time. Changes will be effective immediately upon posting to our website.</p>
          </section>

          <section>
            <h3 class="text-xl font-bold mb-3">9. Contact Information</h3>
            <p class="text-gray-700">
              For questions about these terms, contact us at:<br>
              Email: amtennis2005@gmail.com<br>
              Phone: (267) 738-7290
            </p>
          </section>

          <p class="text-sm text-gray-500 mt-8">Last updated: December 12, 2025</p>
        </div>
      `;
    }

    function getPrivacyPolicy() {
      return `
        <div class="space-y-6">
          <section>
            <h3 class="text-xl font-bold mb-3">1. Information We Collect</h3>
            <p class="text-gray-700 mb-2">When you book a lesson, we collect:</p>
            <ul class="list-disc ml-6 text-gray-700 space-y-1">
              <li>Name</li>
              <li>Email address</li>
              <li>Phone number (optional)</li>
              <li>Lesson preferences (coach, date, time, duration)</li>
              <li>Special notes or requests</li>
            </ul>
          </section>

          <section>
            <h3 class="text-xl font-bold mb-3">2. How We Use Your Information</h3>
            <p class="text-gray-700 mb-2">We use your information to:</p>
            <ul class="list-disc ml-6 text-gray-700 space-y-1">
              <li>Process and confirm your lesson bookings</li>
              <li>Send booking confirmations and calendar invitations</li>
              <li>Communicate about lesson details, changes, or cancellations</li>
              <li>Maintain booking records for business operations</li>
              <li>Improve our services</li>
            </ul>
          </section>

          <section>
            <h3 class="text-xl font-bold mb-3">3. Data Storage and Security</h3>
            <p class="text-gray-700">Your booking information is securely stored using Google Firebase Firestore. We implement appropriate security measures to protect your personal information from unauthorized access, alteration, or disclosure.</p>
          </section>

          <section>
            <h3 class="text-xl font-bold mb-3">4. Email Communications</h3>
            <p class="text-gray-700">We use EmailJS to send booking confirmations and notifications. Your email address is used solely for lesson-related communications and will not be shared with third parties for marketing purposes.</p>
          </section>

          <section>
            <h3 class="text-xl font-bold mb-3">5. Information Sharing</h3>
            <p class="text-gray-700">We do not sell, trade, or rent your personal information to third parties. Your information is shared only with:</p>
            <ul class="list-disc ml-6 text-gray-700 space-y-1">
              <li>Your assigned coach for lesson coordination</li>
              <li>Service providers necessary for booking operations (Firebase, EmailJS)</li>
            </ul>
          </section>

          <section>
            <h3 class="text-xl font-bold mb-3">6. Data Retention</h3>
            <p class="text-gray-700">We retain your booking information for business record-keeping purposes. You may request deletion of your data by contacting us at amtennis2005@gmail.com.</p>
          </section>

          <section>
            <h3 class="text-xl font-bold mb-3">7. Your Rights</h3>
            <p class="text-gray-700 mb-2">You have the right to:</p>
            <ul class="list-disc ml-6 text-gray-700 space-y-1">
              <li>Access your personal information</li>
              <li>Request correction of inaccurate information</li>
              <li>Request deletion of your information</li>
              <li>Opt out of promotional communications</li>
            </ul>
          </section>

          <section>
            <h3 class="text-xl font-bold mb-3">8. Cookies and Tracking</h3>
            <p class="text-gray-700">Our website uses minimal tracking. We use localStorage for coach authentication only. We do not use cookies for advertising or tracking purposes.</p>
          </section>

          <section>
            <h3 class="text-xl font-bold mb-3">9. Children's Privacy</h3>
            <p class="text-gray-700">Our services are available to students of all ages. If you are booking on behalf of a minor, you consent to the collection and use of their information as described in this policy.</p>
          </section>

          <section>
            <h3 class="text-xl font-bold mb-3">10. Changes to This Policy</h3>
            <p class="text-gray-700">We may update this Privacy Policy from time to time. We will notify you of any significant changes by posting the new policy on our website.</p>
          </section>

          <section>
            <h3 class="text-xl font-bold mb-3">11. Contact Us</h3>
            <p class="text-gray-700">
              For questions about this Privacy Policy or your personal information, contact us at:<br>
              Email: amtennis2005@gmail.com<br>
              Phone: (267) 738-7290
            </p>
          </section>

          <p class="text-sm text-gray-500 mt-8">Last updated: December 12, 2025</p>
        </div>
      `;
    }

    function getCancellationPolicy() {
      return `
        <div class="space-y-6">
          <section>
            <h3 class="text-xl font-bold mb-3">Cancellation Fees</h3>
            <p class="text-gray-700 mb-3">To ensure fair scheduling and compensate coaches for reserved time, the following cancellation fees apply:</p>
            <div class="bg-yellow-50 border-2 border-yellow-300 rounded-lg p-4 mb-4">
              <div class="font-semibold text-lg mb-2">Within 24 Hours of Lesson:</div>
              <ul class="list-disc ml-6 text-gray-700 space-y-2">
                <li><strong>60-minute lesson:</strong> $15 cancellation fee</li>
                <li><strong>90-minute lesson:</strong> $20 cancellation fee</li>
              </ul>
            </div>
            <div class="bg-green-50 border-2 border-green-300 rounded-lg p-4">
              <div class="font-semibold text-lg mb-2">More Than 24 Hours Before Lesson:</div>
              <p class="text-gray-700"><strong>No fee</strong> - Full refund or free rescheduling</p>
            </div>
          </section>

          <section>
            <h3 class="text-xl font-bold mb-3">How to Cancel</h3>
            <p class="text-gray-700 mb-2">To cancel your lesson, please contact us as soon as possible:</p>
            <ul class="list-disc ml-6 text-gray-700 space-y-1">
              <li>Email: amtennis2005@gmail.com</li>
              <li>Phone: (267) 738-7290</li>
              <li>Text: (267) 738-7290</li>
            </ul>
            <p class="text-gray-700 mt-3">Please include your booking confirmation number in your cancellation request.</p>
          </section>

          <section>
            <h3 class="text-xl font-bold mb-3">Rescheduling</h3>
            <p class="text-gray-700">If you need to reschedule (rather than cancel), the same 24-hour policy applies. Reschedules requested more than 24 hours in advance incur no fees.</p>
          </section>

          <section>
            <h3 class="text-xl font-bold mb-3">Weather Cancellations</h3>
            <p class="text-gray-700 mb-2">Coach-Initiated: If your coach cancels due to weather, you will receive a full refund or free rescheduling with no fees.</p>
            <p class="text-gray-700 mt-2">Student-Initiated: If you cancel due to weather concerns, standard cancellation fees apply. We recommend checking the weather forecast provided on the booking page.</p>
          </section>

          <section>
            <h3 class="text-xl font-bold mb-3">No-Shows</h3>
            <p class="text-gray-700">If you do not arrive for your scheduled lesson and did not cancel in advance, you will be charged the full lesson price.</p>
          </section>

          <section>
            <h3 class="text-xl font-bold mb-3">Emergency Exceptions</h3>
            <p class="text-gray-700">We understand that emergencies happen. In case of medical emergencies or unforeseen circumstances, please contact us to discuss your situation. We will work with you on a case-by-case basis.</p>
          </section>

          <section>
            <h3 class="text-xl font-bold mb-3">Refund Processing</h3>
            <p class="text-gray-700">If you are eligible for a refund, it will be processed using the same payment method within 5-7 business days.</p>
          </section>

          <p class="text-sm text-gray-500 mt-8">Last updated: December 12, 2025</p>
        </div>
      `;
    }

    // Render function
    function render() {
      const app = document.getElementById('app');
      
      if (state.loading) {
        app.innerHTML = `
          <div class="min-h-screen flex flex-col items-center justify-center">
            <div class="tennis-ball-spinner">üéæ</div>
            <div class="text-xl mt-4 text-gray-600">Loading...</div>
          </div>
        `;
        return;
      }

      const stats = {
        total: state.bookings.length,
        confirmed: state.bookings.filter(b => b.status === 'confirmed').length,
        completed: state.bookings.filter(b => b.status === 'completed').length,
        cancelled: state.bookings.filter(b => b.status === 'cancelled').length,
        revenue: state.bookings.filter(b => b.status !== 'cancelled').reduce((sum, b) => sum + parseFloat(b.price), 0)
      };

      const filteredBookings = state.bookings.filter(b => {
        if (state.filter === 'all') return true;
        return b.status === state.filter;
      });

      app.innerHTML = `
        <div class="min-h-screen">
          <!-- Header -->
          <header class="bg-black text-white py-6 px-4 shadow-lg">
            <div class="max-w-7xl mx-auto flex items-center justify-between flex-wrap gap-4">
              <div>
                <h1 class="text-3xl font-bold">AM Tennis Academy</h1>
                <p class="text-gray-400 text-sm mt-1">Book a private lesson (Alex ‚Ä¢ Aaron ‚Ä¢ Mikkel)</p>
              </div>
              <div class="flex gap-2 flex-wrap">
                <button onclick="switchView('booking')" class="px-6 py-2 rounded-full font-semibold transition ${state.view === 'booking' ? 'bg-white text-black' : 'bg-gray-800 text-white hover:bg-gray-700'}">
                  üìÖ Book
                </button>
                <button onclick="switchView('fitness')" class="px-6 py-2 rounded-full font-semibold transition ${state.view === 'fitness' ? 'bg-white text-black' : 'bg-gray-800 text-white hover:bg-gray-700'}">
                  üí™ Fitness
                </button>
                <button onclick="switchView('stringing')" class="px-6 py-2 rounded-full font-semibold transition ${state.view === 'stringing' ? 'bg-white text-black' : 'bg-gray-800 text-white hover:bg-gray-700'}">
                  üéæ Stringing
                </button>
                <button onclick="switchView('contact')" class="px-6 py-2 rounded-full font-semibold transition ${state.view === 'contact' ? 'bg-white text-black' : 'bg-gray-800 text-white hover:bg-gray-700'}">
                  üìû Contact
                </button>
                ${state.isAuthenticated ? `
                  <button onclick="switchView('admin')" class="px-6 py-2 rounded-full font-semibold transition ${state.view === 'admin' ? 'bg-white text-black' : 'bg-gray-800 text-white hover:bg-gray-700'}">
                    üë• Admin
                  </button>
                  <button onclick="downloadReport()" class="px-6 py-2 rounded-full font-semibold transition bg-green-600 text-white hover:bg-green-700">
                    üìÑ Report
                  </button>
                  <button onclick="logout()" class="px-6 py-2 rounded-full font-semibold transition bg-red-600 text-white hover:bg-red-700">
                    üö™ Logout (${state.currentCoach})
                  </button>
                ` : `
                  <button onclick="switchView('login')" class="px-6 py-2 rounded-full font-semibold transition ${state.view === 'login' ? 'bg-white text-black' : 'bg-gray-800 text-white hover:bg-gray-700'}">
                    üîë Coach Login
                  </button>
                `}
              </div>
            </div>
          </header>

          <main class="py-8">
            ${state.view === 'booking' ? renderBookingView() : 
              state.view === 'fitness' ? renderFitnessView() :
              state.view === 'stringing' ? renderStringingView() :
              state.view === 'contact' ? renderContactView() : 
              state.view === 'login' ? renderLoginView() :
              renderAdminView(stats, filteredBookings)}
          </main>

          <!-- Footer -->
          <footer class="bg-gray-900 text-white py-8 px-4 mt-12">
            <div class="max-w-7xl mx-auto">
              <div class="grid md:grid-cols-3 gap-8 mb-6">
                <div>
                  <h3 class="text-xl font-bold mb-3">AM Tennis Academy</h3>
                  <p class="text-gray-400 text-sm">Professional tennis coaching with Division 1 college players in Newtown, PA</p>
                </div>
                <div>
                  <h3 class="text-lg font-semibold mb-3">Quick Links</h3>
                  <div class="space-y-2 text-sm">
                    <div><button onclick="switchView('booking')" class="text-gray-400 hover:text-white transition">Book a Lesson</button></div>
                    <div><button onclick="switchView('fitness')" class="text-gray-400 hover:text-white transition">Fitness Training</button></div>
                    <div><button onclick="switchView('stringing')" class="text-gray-400 hover:text-white transition">Racquet Stringing</button></div>
                    <div><button onclick="switchView('contact')" class="text-gray-400 hover:text-white transition">Contact Us</button></div>
                  </div>
                </div>
                <div>
                  <h3 class="text-lg font-semibold mb-3">Contact Info</h3>
                  <div class="text-sm text-gray-400">
                    <div>üìß amtennis2005@gmail.com</div>
                    <div>üìû (267) 738-7290</div>
                  </div>
                </div>
              </div>
              <div class="border-t border-gray-700 pt-6 mt-6">
                <div class="flex flex-col md:flex-row justify-between items-center gap-4 text-sm text-gray-400">
                  <div>¬© ${new Date().getFullYear()} AM Tennis Academy. All rights reserved.</div>
                  <div class="flex gap-4">
                    <a href="#" onclick="showPolicyModal('terms'); return false;" class="hover:text-white transition">Terms of Service</a>
                    <span>‚Ä¢</span>
                    <a href="#" onclick="showPolicyModal('privacy'); return false;" class="hover:text-white transition">Privacy Policy</a>
                    <span>‚Ä¢</span>
                    <a href="#" onclick="showPolicyModal('cancellation'); return false;" class="hover:text-white transition">Cancellation Policy</a>
                  </div>
                </div>
              </div>
            </div>
          </footer>

          <!-- Policy Modal -->
          ${state.showPolicy ? `
            <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4" onclick="closePolicyModal(event)">
              <div class="bg-white rounded-xl shadow-2xl max-w-3xl w-full max-h-[90vh] overflow-hidden" onclick="event.stopPropagation()">
                <div class="bg-blue-600 text-white px-6 py-4 flex items-center justify-between">
                  <h2 class="text-2xl font-bold">
                    ${state.showPolicy === 'terms' ? 'Terms of Service' : 
                      state.showPolicy === 'privacy' ? 'Privacy Policy' : 
                      'Cancellation Policy'}
                  </h2>
                  <button onclick="closePolicyModal()" class="text-white hover:text-gray-200 text-3xl leading-none">&times;</button>
                </div>
                <div class="p-6 overflow-y-auto" style="max-height: calc(90vh - 80px);">
                  ${state.showPolicy === 'terms' ? getTermsOfService() : 
                    state.showPolicy === 'privacy' ? getPrivacyPolicy() : 
                    getCancellationPolicy()}
                </div>
                <div class="bg-gray-50 px-6 py-4 flex justify-end border-t">
                  <button onclick="closePolicyModal()" class="bg-blue-600 text-white px-6 py-2 rounded-full font-semibold hover:bg-blue-700 transition">Close</button>
                </div>
              </div>
            </div>
          ` : ''}
        </div>
      `;
    }

    function renderBookingView() {
      const timeSlots = generateTimeSlots();
      
      const coachInfo = {
        'Alex': {
          name: 'Alex Sterin',
          title: 'Division 1 tennis player @ Penn State',
          photo: 'https://media.licdn.com/dms/image/v2/D4E03AQHaDbeOBH_N_A/profile-displayphoto-crop_800_800/B4EZo6nxDiHMAI-/0/1761920095274?e=1767225600&v=beta&t=9IoAGCCzSVrwsmYFLauR4-zQf1gQICG-S_JZwLXMqXY'
        },
        'Aaron': {
          name: 'Aaron Sandler',
          title: 'Division 1 Tennis Player at Penn',
          photo: 'https://pennathletics.com/images/2025/9/9/Aaron_Sandler_Crooped.jpg'
        },
        'Mikkel': {
          name: 'Mikkel Zinder',
          title: 'Division 1 Tennis Player at Dayton',
          photo: 'https://i.imgur.com/4unb6ao.jpg'
        }
      };
      
      return `
        <div class="max-w-6xl mx-auto p-6">
          <!-- Meet Our Coaches Section -->
          <div class="bg-white rounded-xl shadow-lg p-8 mb-8">
            <h2 class="text-3xl font-bold mb-6 text-center">Meet Our Coaches</h2>
            <div class="grid md:grid-cols-3 gap-6">
              ${Object.keys(coachInfo).map(coach => `
                <div class="text-center p-4 rounded-lg hover:bg-gray-50 transition cursor-pointer" onclick="selectCoachFromCard('${coach}')">
                  <div class="mb-4">
                    <img src="${coachInfo[coach].photo}" alt="${coachInfo[coach].name}" class="w-32 h-32 rounded-full mx-auto object-cover border-4 border-blue-500 shadow-lg">
                  </div>
                  <h3 class="text-xl font-bold mb-2">${coachInfo[coach].name}</h3>
                  <a href="#" onclick="event.stopPropagation(); alert('Instagram URL coming soon!'); return false;" class="text-pink-500 hover:text-pink-600 text-2xl" title="Instagram">üì∏</a>
                  <p class="text-sm text-gray-600 mb-3 mt-2">üéæ ${coachInfo[coach].title}</p>
                  <button class="bg-blue-600 text-white px-4 py-2 rounded-full text-sm font-semibold hover:bg-blue-700 transition">
                    Book with ${coach}
                  </button>
                </div>
              `).join('')}
            </div>
          </div>

          <!-- Booking Form -->
          <div class="bg-white rounded-xl shadow-lg p-8">
            <h2 class="text-2xl font-bold mb-6 pb-3 border-b">Book a Lesson</h2>

            <div class="grid md:grid-cols-2 gap-6 mb-6">
              <div>
                <label class="block text-sm font-semibold mb-2">Choose a Coach</label>
                <select id="coach" class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500" onchange="updateCoachInfo()">
                  <option value="Alex" ${state.coach === 'Alex' ? 'selected' : ''}>Alex</option>
                  <option value="Aaron" ${state.coach === 'Aaron' ? 'selected' : ''}>Aaron Sandler</option>
                  <option value="Mikkel" ${state.coach === 'Mikkel' ? 'selected' : ''}>Mikkel Zinder</option>
                </select>
                <div id="coachInfo" class="mt-2 text-sm text-blue-600 font-medium">
                  üéæ ${coachInfo[state.coach].title}
                </div>
              </div>

              <div>
                <label class="block text-sm font-semibold mb-2">Lesson Length</label>
                <select id="duration" class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500" onchange="updatePrice()">
                  <option value="60" ${state.duration === '60' ? 'selected' : ''}>60 Minutes ($65)</option>
                  <option value="90" ${state.duration === '90' ? 'selected' : ''}>90 Minutes ($97.50)</option>
                </select>
                <div class="text-sm text-gray-600 mt-1">Rate: $65 per hour</div>
                <div id="priceDisplay" class="mt-2 p-3 bg-green-50 border border-green-200 rounded-lg">
                  <span class="font-semibold text-green-900">Total Price: $${state.duration === '60' ? '65.00' : '97.50'}</span>
                </div>
              </div>
            </div>

            <div class="mb-6">
              <label class="block text-sm font-semibold mb-2">Select a Date</label>
              <input type="date" id="date" value="${state.date}" min="${new Date().toISOString().split('T')[0]}" class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500" onchange="updateWeather()">
              ${state.weather ? `
                <div class="mt-3 p-3 bg-blue-50 border border-blue-200 rounded-lg flex items-center gap-3">
                  <div class="text-3xl">${state.weather.emoji}</div>
                  <div class="flex-1">
                    <div class="font-semibold text-blue-900">${state.weather.description}</div>
                    <div class="text-sm text-blue-700">High: ${state.weather.tempMax}¬∞F | Low: ${state.weather.tempMin}¬∞F</div>
                    <div class="text-xs text-blue-600">Rain chance: ${state.weather.rainChance}%</div>
                  </div>
                </div>
              ` : ''}
            </div>

            <button onclick="showTimes()" class="bg-blue-600 text-white px-6 py-3 rounded-full font-semibold hover:bg-blue-700 transition mb-4">
              Show Available Times
            </button>

            ${state.showSlots ? `
              <div class="mb-6 p-4 bg-gray-50 rounded-lg">
                <div class="font-semibold mb-3">Available times for ${state.date}:</div>
                <div class="mb-3 p-3 bg-yellow-50 border border-yellow-300 rounded-lg text-sm text-yellow-800">
                  ‚è∞ <strong>Business Hours:</strong> 8:00 AM - 8:00 PM. Slots outside these hours may require special arrangement.
                </div>
                <div class="flex flex-wrap gap-2">
                  ${timeSlots.map(slot => {
                    const booked = isSlotBooked(slot);
                    return `
                      <button 
                        onclick="${booked ? '' : `selectSlot('${slot}')`}"
                        ${booked ? 'disabled' : ''}
                        class="px-4 py-2 rounded-full text-sm font-medium transition ${
                          booked ? 'bg-gray-200 text-gray-400 cursor-not-allowed' :
                          state.selectedSlot === slot ? 'bg-blue-600 text-white' :
                          'bg-white border-2 border-blue-600 text-blue-600 hover:bg-blue-50'
                        }">
                        ${slot} ${booked ? '(Booked)' : ''}
                      </button>
                    `;
                  }).join('')}
                </div>
              </div>
            ` : ''}

            <div class="border-t pt-6 mt-6">
              <h3 class="text-lg font-bold mb-4">Payment Information</h3>
              <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
                <div class="font-semibold text-blue-900 mb-2">üí≥ Payment Options:</div>
                <div class="space-y-1 text-sm text-blue-800">
                  <div><strong>Venmo:</strong> @AMTennis</div>
                  <div><strong>Zelle:</strong> amtennis@email.com</div>
                  <div><strong>Cash/Check:</strong> Accepted at the lesson</div>
                </div>
                <div class="mt-3 text-xs text-blue-700">
                  Payment can be made before or at the time of your lesson.
                </div>
              </div>
            </div>

            <div class="border-t pt-6 mt-6">
              <h3 class="text-lg font-bold mb-4">Your Information</h3>

              <div class="space-y-4">
                <div>
                  <label class="block text-sm font-semibold mb-2">Player Name *</label>
                  <input type="text" id="name" value="${state.name}" placeholder="Your name" class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500">
                </div>

                <div>
                  <label class="block text-sm font-semibold mb-2">Email *</label>
                  <input type="email" id="email" value="${state.email}" placeholder="you@example.com" class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500">
                </div>

                <div>
                  <label class="block text-sm font-semibold mb-2">Phone (optional)</label>
                  <input type="tel" id="phone" value="${state.phone}" placeholder="(xxx) xxx-xxxx" class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500">
                </div>

                <div>
                  <label class="block text-sm font-semibold mb-2">Notes (optional)</label>
                  <textarea id="notes" placeholder="Anything we should know?" rows="3" class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500">${state.notes}</textarea>
                </div>
              </div>
            </div>

            <button onclick="bookLesson()" ${state.sending ? 'disabled' : ''} class="w-full bg-blue-600 text-white px-6 py-4 rounded-full font-bold text-lg hover:bg-blue-700 transition mt-6 disabled:bg-gray-400">
              ${state.sending ? 'Processing...' : 'Book Lesson'}
            </button>

            ${state.message.text ? `
              <div class="mt-4 p-4 rounded-lg ${state.message.type === 'success' ? 'bg-green-50 text-green-800 border border-green-200' : 'bg-red-50 text-red-800 border border-red-200'}">
                ${state.message.text}
              </div>
            ` : ''}
          </div>
        </div>
      `;
    }

    function renderLoginView() {
      return `
        <div class="max-w-md mx-auto p-6">
          <div class="bg-white rounded-xl shadow-lg p-8">
            <h2 class="text-3xl font-bold mb-6 text-center">üîë Coach Login</h2>
            <p class="text-gray-600 text-center mb-6">Login to access admin panel and booking data</p>

            <form onsubmit="handleLogin(event)" class="space-y-4">
              <div>
                <label class="block text-sm font-semibold mb-2">Username</label>
                <input 
                  type="text" 
                  id="loginUsername" 
                  placeholder="alex, aaron, or mikkel" 
                  class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500"
                  required
                >
              </div>

              <div>
                <label class="block text-sm font-semibold mb-2">Password</label>
                <input 
                  type="password" 
                  id="loginPassword" 
                  placeholder="Enter your password" 
                  class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500"
                  required
                >
              </div>

              ${state.loginError ? `
                <div class="p-3 bg-red-50 text-red-800 border border-red-200 rounded-lg text-sm">
                  ‚ö†Ô∏è ${state.loginError}
                </div>
              ` : ''}

              <button 
                type="submit" 
                class="w-full bg-blue-600 text-white px-6 py-3 rounded-full font-bold text-lg hover:bg-blue-700 transition"
              >
                Login
              </button>
            </form>
          </div>
        </div>
      `;
    }

    function renderContactView() {
      return `
        <div class="max-w-4xl mx-auto p-6">
          <div class="bg-white rounded-xl shadow-lg p-8">
            <h2 class="text-3xl font-bold mb-6 pb-3 border-b">Contact Us</h2>

            <div class="space-y-6">
              <!-- Email -->
              <div class="bg-green-50 border border-green-200 rounded-lg p-6">
                <div class="flex items-start gap-3">
                  <div class="text-3xl">‚úâÔ∏è</div>
                  <div>
                    <h3 class="text-xl font-bold text-green-900 mb-2">Email</h3>
                    <a href="mailto:amtennis2005@gmail.com" class="text-green-700 hover:text-green-900 font-medium text-lg">
                      amtennis2005@gmail.com
                    </a>
                  </div>
                </div>
              </div>

              <!-- Phone Numbers -->
              <div class="bg-purple-50 border border-purple-200 rounded-lg p-6">
                <div class="flex items-start gap-3">
                  <div class="text-3xl">üìû</div>
                  <div class="w-full">
                    <h3 class="text-xl font-bold text-purple-900 mb-3">Phone Numbers</h3>
                    <div class="space-y-2">
                      <div class="flex justify-between items-center">
                        <span class="text-purple-800 font-semibold">Alex Sterin:</span>
                        <a href="tel:+12677387290" class="text-purple-700 hover:text-purple-900 font-medium">(267) 738-7290</a>
                      </div>
                      <div class="flex justify-between items-center">
                        <span class="text-purple-800 font-semibold">Aaron Sandler:</span>
                        <a href="tel:+12675755700" class="text-purple-700 hover:text-purple-900 font-medium">(267) 575-5700</a>
                      </div>
                      <div class="flex justify-between items-center">
                        <span class="text-purple-800 font-semibold">Mikkel Zinder:</span>
                        <a href="tel:+12675755700" class="text-purple-700 hover:text-purple-900 font-medium">(267) 575-5700</a>
                      </div>
                      <div class="flex justify-between items-center">
                        <span class="text-purple-800 font-semibold">Alan Pasternak (Stringing):</span>
                        <a href="tel:+12154499148" class="text-purple-700 hover:text-purple-900 font-medium">(215) 449-9148</a>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Payment Info -->
              <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-6">
                <div class="flex items-start gap-3">
                  <div class="text-3xl">üí≥</div>
                  <div>
                    <h3 class="text-xl font-bold text-yellow-900 mb-3">Payment Options</h3>
                    <div class="space-y-1 text-yellow-800">
                      <div><strong>Venmo:</strong> @AMTennis</div>
                      <div><strong>Zelle:</strong> amtennis@email.com</div>
                      <div><strong>Cash/Check:</strong> Accepted at lessons</div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Hours/Info -->
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-6">
                <div class="flex items-start gap-3">
                  <div class="text-3xl">‚è∞</div>
                  <div>
                    <h3 class="text-xl font-bold text-gray-900 mb-2">Lesson Hours</h3>
                    <p class="text-gray-700">Available 8:00 AM - 8:00 PM</p>
                    <p class="text-gray-600 text-sm mt-2">Book your lesson online and we'll confirm your appointment!</p>
                  </div>
                </div>
              </div>
            </div>

            <div class="mt-8 text-center">
              <button onclick="switchView('booking')" class="bg-blue-600 text-white px-8 py-3 rounded-full font-bold text-lg hover:bg-blue-700 transition">
                üìÖ Book a Lesson
              </button>
            </div>
          </div>
        </div>
      `;
    }

    function renderFitnessView() {
      return `
        <div class="max-w-6xl mx-auto p-6">
          <div class="bg-white rounded-xl shadow-lg p-8">
            <h2 class="text-4xl font-bold mb-6 text-center">üí™ Tennis Fitness Training</h2>
            <p class="text-xl text-gray-600 text-center mb-8">Elevate your game with specialized fitness training designed for tennis players</p>
            
            <!-- Program Overview -->
            <div class="bg-gradient-to-br from-orange-50 to-red-50 rounded-xl p-8 mb-8">
              <div class="flex flex-col md:flex-row items-center gap-6">
                <div class="flex-shrink-0">
                  <div class="w-48 h-48 rounded-full bg-gradient-to-br from-orange-400 to-red-500 flex items-center justify-center text-7xl shadow-lg">
                    üèãÔ∏è
                  </div>
                </div>
                <div class="flex-1">
                  <h3 class="text-3xl font-bold mb-3">Complete Athlete Development</h3>
                  <p class="text-lg text-gray-700 mb-4">Our fitness program is specifically designed to enhance your tennis performance through targeted strength, speed, agility, and endurance training.</p>
                  <div class="bg-white rounded-lg p-4">
                    <div class="flex items-center gap-2 text-lg">
                      <span class="text-2xl">üéØ</span>
                      <span class="font-semibold">Tennis-Specific Training Programs</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Training Components -->
            <div class="mb-8">
              <h3 class="text-2xl font-bold mb-6 text-center">What's Included</h3>
              <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6">
                <div class="bg-blue-50 border-2 border-blue-300 rounded-xl p-6 text-center hover:shadow-lg transition">
                  <div class="text-5xl mb-3">üí™</div>
                  <h4 class="text-xl font-bold mb-2">Strength Training</h4>
                  <p class="text-gray-600 text-sm">Build power for stronger serves and groundstrokes</p>
                </div>
                
                <div class="bg-green-50 border-2 border-green-300 rounded-xl p-6 text-center hover:shadow-lg transition">
                  <div class="text-5xl mb-3">‚ö°</div>
                  <h4 class="text-xl font-bold mb-2">Speed & Agility</h4>
                  <p class="text-gray-600 text-sm">Improve court coverage and reaction time</p>
                </div>
                
                <div class="bg-purple-50 border-2 border-purple-300 rounded-xl p-6 text-center hover:shadow-lg transition">
                  <div class="text-5xl mb-3">üèÉ</div>
                  <h4 class="text-xl font-bold mb-2">Endurance</h4>
                  <p class="text-gray-600 text-sm">Maintain peak performance throughout long matches</p>
                </div>
                
                <div class="bg-yellow-50 border-2 border-yellow-300 rounded-xl p-6 text-center hover:shadow-lg transition">
                  <div class="text-5xl mb-3">üßò</div>
                  <h4 class="text-xl font-bold mb-2">Flexibility</h4>
                  <p class="text-gray-600 text-sm">Prevent injuries and improve range of motion</p>
                </div>
              </div>
            </div>

            <!-- Pricing Options -->
            <div class="mb-8">
              <h3 class="text-2xl font-bold mb-6 text-center">Pricing Options</h3>
              <div class="grid md:grid-cols-3 gap-6">
                <!-- Single Session -->
                <div class="bg-white border-2 border-gray-300 rounded-xl p-6 hover:shadow-lg transition">
                  <div class="text-center">
                    <div class="text-4xl mb-4">üé´</div>
                    <h4 class="text-2xl font-bold mb-2">Single Session</h4>
                    <div class="text-4xl font-bold text-blue-600 mb-2">$50</div>
                    <p class="text-gray-600 mb-4">60-minute session</p>
                    <ul class="text-left text-sm text-gray-600 space-y-2 mb-4">
                      <li>‚úì Personalized workout</li>
                      <li>‚úì Professional coaching</li>
                      <li>‚úì Progress tracking</li>
                    </ul>
                  </div>
                </div>
                
                <!-- 5-Session Package -->
                <div class="bg-gradient-to-br from-blue-50 to-blue-100 border-2 border-blue-500 rounded-xl p-6 hover:shadow-xl transition transform hover:-translate-y-1">
                  <div class="text-center">
                    <div class="bg-blue-500 text-white text-xs font-bold px-3 py-1 rounded-full inline-block mb-3">POPULAR</div>
                    <div class="text-4xl mb-4">üì¶</div>
                    <h4 class="text-2xl font-bold mb-2">5-Session Package</h4>
                    <div class="text-4xl font-bold text-blue-600 mb-1">$225</div>
                    <div class="text-sm text-gray-600 mb-2">($45/session - Save $25)</div>
                    <p class="text-gray-600 mb-4">5x 60-minute sessions</p>
                    <ul class="text-left text-sm text-gray-600 space-y-2 mb-4">
                      <li>‚úì Customized program</li>
                      <li>‚úì Nutrition guidance</li>
                      <li>‚úì Weekly progress reviews</li>
                      <li>‚úì Best value</li>
                    </ul>
                  </div>
                </div>
                
                <!-- 10-Session Package -->
                <div class="bg-white border-2 border-green-500 rounded-xl p-6 hover:shadow-lg transition">
                  <div class="text-center">
                    <div class="bg-green-500 text-white text-xs font-bold px-3 py-1 rounded-full inline-block mb-3">BEST DEAL</div>
                    <div class="text-4xl mb-4">üèÜ</div>
                    <h4 class="text-2xl font-bold mb-2">10-Session Package</h4>
                    <div class="text-4xl font-bold text-green-600 mb-1">$400</div>
                    <div class="text-sm text-gray-600 mb-2">($40/session - Save $100)</div>
                    <p class="text-gray-600 mb-4">10x 60-minute sessions</p>
                    <ul class="text-left text-sm text-gray-600 space-y-2 mb-4">
                      <li>‚úì Complete transformation</li>
                      <li>‚úì Meal planning support</li>
                      <li>‚úì Monthly assessments</li>
                      <li>‚úì Maximum savings</li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>

            <!-- Benefits -->
            <div class="bg-gray-50 rounded-xl p-6 mb-8">
              <h3 class="text-xl font-bold mb-4 text-center">Why Add Fitness Training?</h3>
              <div class="grid md:grid-cols-2 gap-4">
                <div class="flex gap-3">
                  <div class="text-2xl">üéæ</div>
                  <div>
                    <div class="font-semibold">Improve On-Court Performance</div>
                    <div class="text-sm text-gray-600">Enhanced power, speed, and endurance translate directly to better match results</div>
                  </div>
                </div>
                <div class="flex gap-3">
                  <div class="text-2xl">üõ°Ô∏è</div>
                  <div>
                    <div class="font-semibold">Injury Prevention</div>
                    <div class="text-sm text-gray-600">Strengthen muscles and joints to reduce risk of common tennis injuries</div>
                  </div>
                </div>
                <div class="flex gap-3">
                  <div class="text-2xl">‚ö°</div>
                  <div>
                    <div class="font-semibold">Faster Recovery</div>
                    <div class="text-sm text-gray-600">Better conditioning means quicker recovery between points and matches</div>
                  </div>
                </div>
                <div class="flex gap-3">
                  <div class="text-2xl">üìà</div>
                  <div>
                    <div class="font-semibold">Long-Term Development</div>
                    <div class="text-sm text-gray-600">Build a foundation for continued improvement and competitive success</div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Who It's For -->
            <div class="bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl p-6 mb-8">
              <h3 class="text-xl font-bold mb-4 text-center">Who Should Train?</h3>
              <div class="grid md:grid-cols-3 gap-6 text-center">
                <div>
                  <div class="text-4xl mb-2">üåü</div>
                  <div class="font-semibold">Beginners</div>
                  <div class="text-sm text-gray-600">Build foundational fitness for tennis success</div>
                </div>
                <div>
                  <div class="text-4xl mb-2">üéØ</div>
                  <div class="font-semibold">Competitive Players</div>
                  <div class="text-sm text-gray-600">Gain the edge over your opponents</div>
                </div>
                <div>
                  <div class="text-4xl mb-2">üèÖ</div>
                  <div class="font-semibold">Tournament Players</div>
                  <div class="text-sm text-gray-600">Peak performance when it matters most</div>
                </div>
              </div>
            </div>

            <!-- Contact CTA -->
            <div class="text-center bg-gradient-to-r from-orange-500 to-red-500 text-white rounded-xl p-8">
              <h3 class="text-2xl font-bold mb-4">Ready to Transform Your Game?</h3>
              <p class="text-lg mb-6">Contact us to schedule your fitness assessment and start your training program</p>
              <div class="flex flex-col sm:flex-row gap-4 justify-center">
                <a href="tel:+12677387290" class="bg-white text-orange-600 px-8 py-3 rounded-full font-bold text-lg hover:bg-gray-100 transition inline-block">
                  üìû Call: (267) 738-7290
                </a>
                <a href="mailto:amtennis2005@gmail.com" class="bg-white text-red-600 px-8 py-3 rounded-full font-bold text-lg hover:bg-gray-100 transition inline-block">
                  ‚úâÔ∏è Email Us
                </a>
              </div>
              <p class="text-sm mt-4 opacity-90">Combine with tennis lessons for the ultimate development program!</p>
            </div>
          </div>
        </div>
      `;
    }

    function renderStringingView() {
      return `
        <div class="max-w-6xl mx-auto p-6">
          <div class="bg-white rounded-xl shadow-lg p-8">
            <h2 class="text-4xl font-bold mb-6 text-center">üéæ Racquet Stringing Service</h2>
            
            <!-- Stringer Profile -->
            <div class="bg-gradient-to-br from-blue-50 to-purple-50 rounded-xl p-8 mb-8">
              <div class="flex flex-col md:flex-row items-center gap-6">
                <div class="flex-shrink-0">
                  <div class="w-48 h-48 rounded-full bg-gray-200 flex items-center justify-center text-6xl border-4 border-blue-500 shadow-lg">
                    üéæ
                  </div>
                  <p class="text-center text-gray-500 text-sm mt-2">Photo coming soon</p>
                </div>
                <div class="flex-1 text-center md:text-left">
                  <h3 class="text-3xl font-bold mb-2">Alan Pasternak</h3>
                  <p class="text-xl text-gray-700 mb-4">Professional Racquet Stringer</p>
                  <div class="bg-white rounded-lg p-4 inline-block">
                    <div class="flex items-center gap-2 text-lg">
                      <span class="text-2xl">‚≠ê</span>
                      <span class="font-semibold">3 Years Experience</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Pricing -->
            <div class="mb-8">
              <h3 class="text-2xl font-bold mb-6 text-center">Pricing</h3>
              <div class="grid md:grid-cols-2 gap-6">
                <!-- With String -->
                <div class="bg-green-50 border-2 border-green-500 rounded-xl p-6 hover:shadow-lg transition">
                  <div class="text-center">
                    <div class="text-5xl mb-4">‚úÖ</div>
                    <h4 class="text-2xl font-bold mb-2">With String</h4>
                    <div class="text-5xl font-bold text-green-600 mb-2">$15</div>
                    <p class="text-gray-600">You provide the string</p>
                  </div>
                </div>
                
                <!-- Without String -->
                <div class="bg-blue-50 border-2 border-blue-500 rounded-xl p-6 hover:shadow-lg transition">
                  <div class="text-center">
                    <div class="text-5xl mb-4">üéÅ</div>
                    <h4 class="text-2xl font-bold mb-2">Without String</h4>
                    <div class="text-5xl font-bold text-blue-600 mb-2">$25</div>
                    <p class="text-gray-600">String provided by us</p>
                  </div>
                </div>
              </div>
            </div>

            <!-- Service Info -->
            <div class="bg-gray-50 rounded-xl p-6 mb-8">
              <h3 class="text-xl font-bold mb-4 text-center">Service Details</h3>
              <div class="grid md:grid-cols-3 gap-4 text-center">
                <div>
                  <div class="text-3xl mb-2">‚ö°</div>
                  <div class="font-semibold">Quick Turnaround</div>
                  <div class="text-sm text-gray-600">Usually 24-48 hours</div>
                </div>
                <div>
                  <div class="text-3xl mb-2">üéØ</div>
                  <div class="font-semibold">Professional Quality</div>
                  <div class="text-sm text-gray-600">3 years of experience</div>
                </div>
                <div>
                  <div class="text-3xl mb-2">üìç</div>
                  <div class="font-semibold">Convenient Location</div>
                  <div class="text-sm text-gray-600">Newtown, PA</div>
                </div>
              </div>
            </div>

            <!-- Contact for Stringing -->
            <div class="text-center bg-gradient-to-r from-blue-500 to-purple-500 text-white rounded-xl p-8">
              <h3 class="text-2xl font-bold mb-4">Ready to Get Your Racquet Strung?</h3>
              <p class="text-lg mb-6">Contact us to schedule your stringing service</p>
              <div class="flex flex-col sm:flex-row gap-4 justify-center">
                <a href="tel:+12154499148" class="bg-white text-blue-600 px-8 py-3 rounded-full font-bold text-lg hover:bg-gray-100 transition inline-block">
                  üìû Call Alan: (215) 449-9148
                </a>
                <a href="mailto:amtennis2005@gmail.com" class="bg-white text-purple-600 px-8 py-3 rounded-full font-bold text-lg hover:bg-gray-100 transition inline-block">
                  ‚úâÔ∏è Email Us
                </a>
              </div>
            </div>
          </div>
        </div>
      `;
    }

    function renderAdminView(stats, filteredBookings) {
      return `
        <div class="max-w-7xl mx-auto p-6">
          <h1 class="text-3xl font-bold mb-8">Admin Dashboard</h1>

          <!-- Stats -->
          <div class="grid md:grid-cols-5 gap-4 mb-8">
            <div class="bg-white p-6 rounded-xl shadow">
              <div class="text-gray-500 text-sm">Total Bookings</div>
              <div class="text-3xl font-bold">${stats.total}</div>
            </div>
            <div class="bg-white p-6 rounded-xl shadow">
              <div class="text-gray-500 text-sm">Confirmed</div>
              <div class="text-3xl font-bold text-green-600">${stats.confirmed}</div>
            </div>
            <div class="bg-white p-6 rounded-xl shadow">
              <div class="text-gray-500 text-sm">Completed</div>
              <div class="text-3xl font-bold text-blue-600">${stats.completed}</div>
            </div>
            <div class="bg-white p-6 rounded-xl shadow">
              <div class="text-gray-500 text-sm">Cancelled</div>
              <div class="text-3xl font-bold text-red-600">${stats.cancelled}</div>
            </div>
            <div class="bg-white p-6 rounded-xl shadow">
              <div class="text-gray-500 text-sm">Revenue</div>
              <div class="text-3xl font-bold text-green-600">$${stats.revenue.toFixed(0)}</div>
            </div>
          </div>

          <!-- Filters -->
          <div class="bg-white p-4 rounded-xl shadow mb-6">
            <div class="flex gap-2 flex-wrap">
              ${['all', 'confirmed', 'completed', 'cancelled'].map(f => `
                <button onclick="setFilter('${f}')" class="px-4 py-2 rounded-full font-medium capitalize transition ${state.filter === f ? 'bg-blue-600 text-white' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'}">
                  ${f}
                </button>
              `).join('')}
            </div>
          </div>

          <!-- Table -->
          <div class="bg-white rounded-xl shadow overflow-hidden">
            <div class="overflow-x-auto">
              <table class="w-full">
                <thead class="bg-gray-50 border-b">
                  <tr>
                    <th class="px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase">Date & Time</th>
                    <th class="px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase">Coach</th>
                    <th class="px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase">Client</th>
                    <th class="px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase">Contact</th>
                    <th class="px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase">Duration</th>
                    <th class="px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase">Price</th>
                    <th class="px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase">Status</th>
                    <th class="px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase">Actions</th>
                  </tr>
                </thead>
                <tbody class="divide-y">
                  ${filteredBookings.map(booking => `
                    <tr class="hover:bg-gray-50">
                      <td class="px-6 py-4">
                        <div class="font-medium">${booking.date}</div>
                        <div class="text-sm text-gray-500">${booking.time}</div>
                      </td>
                      <td class="px-6 py-4 font-medium">${booking.coach}</td>
                      <td class="px-6 py-4">
                        <div class="font-medium">${booking.name}</div>
                        ${booking.notes ? `<div class="text-xs text-gray-500 mt-1">${booking.notes}</div>` : ''}
                      </td>
                      <td class="px-6 py-4">
                        <div class="text-sm">${booking.email}</div>
                        ${booking.phone ? `<div class="text-sm text-gray-500">${booking.phone}</div>` : ''}
                      </td>
                      <td class="px-6 py-4">${booking.duration} min</td>
                      <td class="px-6 py-4 font-semibold">$${booking.price}</td>
                      <td class="px-6 py-4">
                        <span class="px-3 py-1 rounded-full text-xs font-semibold ${
                          booking.status === 'confirmed' ? 'bg-green-100 text-green-800' :
                          booking.status === 'completed' ? 'bg-blue-100 text-blue-800' :
                          'bg-red-100 text-red-800'
                        }">
                          ${booking.status}
                        </span>
                      </td>
                      <td class="px-6 py-4">
                        <select onchange="updateStatus('${booking.id}', this.value)" class="text-sm border rounded px-2 py-1 mr-2">
                          <option value="confirmed" ${booking.status === 'confirmed' ? 'selected' : ''}>Confirmed</option>
                          <option value="completed" ${booking.status === 'completed' ? 'selected' : ''}>Completed</option>
                          <option value="cancelled" ${booking.status === 'cancelled' ? 'selected' : ''}>Cancelled</option>
                        </select>
                        <button onclick="deleteBookingAction('${booking.id}')" class="text-red-600 hover:text-red-800 text-sm font-medium">
                          Delete
                        </button>
                      </td>
                    </tr>
                  `).join('')}
                </tbody>
              </table>
            </div>
            ${filteredBookings.length === 0 ? '<div class="text-center py-12 text-gray-500">No bookings found for this filter.</div>' : ''}
          </div>
        </div>
      `;
    }

    // Event handlers
    window.switchView = (view) => {
      state.view = view;
      render();
    };

    window.showTimes = () => {
      state.coach = document.getElementById('coach').value;
      state.duration = document.getElementById('duration').value;
      state.date = document.getElementById('date').value;
      
      if (!state.date) {
        state.message = { type: 'error', text: 'Please select a date first.' };
        render();
        return;
      }
      
      state.showSlots = true;
      state.selectedSlot = null;
      state.message = { type: '', text: '' };
      render();
      
      // Auto-scroll to time slots
      setTimeout(() => {
        const slotsContainer = document.querySelector('.bg-gray-50.rounded-lg');
        if (slotsContainer) {
          slotsContainer.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
      }, 100);
    };

    window.selectSlot = (slot) => {
      state.selectedSlot = slot;
      render();
    };

    window.selectCoachFromCard = (coach) => {
      state.coach = coach;
      // Scroll to booking form
      setTimeout(() => {
        const bookingForm = document.querySelector('.max-w-6xl > .bg-white:last-child');
        if (bookingForm) {
          bookingForm.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
      }, 100);
      render();
    };

    window.updateWeather = async () => {
      const date = document.getElementById('date').value;
      if (date) {
        state.date = date;
        state.weather = await fetchWeather(date);
        render();
      }
    };
    
    window.downloadLessonCalendar = () => {
      if (state.lastBooking) {
        downloadCalendar(state.lastBooking);
      }
    };

    window.bookLesson = () => {
      state.coach = document.getElementById('coach').value;
      state.duration = document.getElementById('duration').value;
      state.date = document.getElementById('date').value;
      state.name = document.getElementById('name').value;
      state.email = document.getElementById('email').value;
      state.phone = document.getElementById('phone').value;
      state.notes = document.getElementById('notes').value;
      handleBooking();
    };

    window.setFilter = (filter) => {
      state.filter = filter;
      render();
    };

    window.updateStatus = (bookingId, newStatus) => {
      updateBookingStatus(bookingId, newStatus);
    };

    window.deleteBookingAction = (bookingId) => {
      deleteBooking(bookingId);
    };

    window.updateCoachInfo = () => {
      const coach = document.getElementById('coach').value;
      const coachInfo = {
        'Alex': 'Division 1 tennis player @ Penn State',
        'Aaron': 'Aaron Sandler - Division 1 Tennis Player at Penn',
        'Mikkel': 'Mikkel Zinder - Division 1 Tennis Player at Dayton'
      };
      const infoElement = document.getElementById('coachInfo');
      if (infoElement) {
        infoElement.textContent = 'üéæ ' + coachInfo[coach];
      }
    };

    window.updatePrice = () => {
      const duration = document.getElementById('duration').value;
      const price = duration === '60' ? '65.00' : '97.50';
      const priceDisplay = document.getElementById('priceDisplay');
      if (priceDisplay) {
        priceDisplay.innerHTML = `<span class="font-semibold text-green-900">Total Price: $${price}</span>`;
      }
    };

    window.handleLogin = (event) => {
      event.preventDefault();
      const username = document.getElementById('loginUsername').value;
      const password = document.getElementById('loginPassword').value;
      
      const auth = login(username, password);
      if (auth) {
        state.isAuthenticated = true;
        state.currentCoach = auth.name;
        state.loginError = '';
        state.view = 'admin';
        render();
      } else {
        state.loginError = 'Invalid username or password';
        render();
      }
    };

    window.showPolicyModal = (policyType) => {
      state.showPolicy = policyType;
      render();
    };

    window.closePolicyModal = (event) => {
      if (!event || event.target === event.currentTarget) {
        state.showPolicy = null;
        render();
      }
    };

    // Initialize
    const auth = checkAuth();
    if (auth) {
      state.isAuthenticated = true;
      state.currentCoach = auth.name;
    }
    loadBookings();
  </script>
</body>
</html>